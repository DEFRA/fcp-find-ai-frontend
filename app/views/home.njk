{# Backstage scaffolder to render the file as is and to skip this content to interpret as template   #}
{% extends '_layout.njk' %}

{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "components/macro-chat-message.njk" import chatMessage %}

{% block content %}
  <div class="govuk-grid-row">
    {{ govukWarningText({
        text: "You must personally check results from this service before passing on any information",
        iconFallbackText: "Warning"
    }) }}

    <p class="govuk-body">
      {% for message in messages %}
        {{ chatMessage({
          answer: message.answer,
          urls: message.source_urls
        }) }}
      {% endfor %}
    </p>

    {% if envTest %}
      <input type="hidden" value="{{ envTest }}"/>
    {% endif %}

    <input type="hidden" value="{{ fundingFarmingApiUri }}"/>
    <input type="hidden" name="appInsightsKey" value="{{ appInsightsKey }}"/>

    {% if validationError %}
      {% set errorMessageText %} Please enter your query here {% endset %}
    {% endif %}

    <form method="POST" id="sendForm">
      {{ govukInput({
        id: "prompt-id", 
        name: "input",
        errorMessage: {
          text: "Please enter your query here"
        } if errorMessageText else undefined
      }) }}

      {{ govukButton({
        id: "sendButton",
        text: "Send",
        type: "submit" 
      }) }}
    </form>

    {% include "components/instructions.njk" %}
  </div>
{% endblock %}